[source,bash,subs="attributes"]
----
# Once CSRs in state Pending show up, approve them
ifeval::["{provider}"=="cloudscale"]
# Needs to be run three times, three CSRs for each node need to be approved
endif::[]
ifeval::["{provider}"!="cloudscale"]
# Needs to be run twice, two CSRs for each node need to be approved
endif::[]

ifdef::kubectl_extra_args[]
kubectl {kubectl_extra_args} get csr -w
endif::kubectl_extra_args[]
ifndef::kubectl_extra_args[]
kubectl get csr -w
endif::kubectl_extra_args[]

ifdef::kubectl_extra_args[]
oc {kubectl_extra_args} get csr -o go-template='{{range .items}}{{if not .status}}{{.metadata.name}}{{"\n"}}{{end}}{{end}}' | \
  xargs oc {kubectl_extra_args} adm certificate approve
endif::kubectl_extra_args[]
ifndef::kubectl_extra_args[]
oc get csr -o go-template='{{range .items}}{{if not .status}}{{.metadata.name}}{{"\n"}}{{end}}{{end}}' | \
  xargs oc adm certificate approve
endif::kubectl_extra_args[]

ifdef::kubectl_extra_args[]
kubectl {kubectl_extra_args} get nodes
endif::kubectl_extra_args[]
ifndef::kubectl_extra_args[]
kubectl get nodes
endif::kubectl_extra_args[]
----
